
# cloudxls-node

Node.js API bindings for [cloudxls.com](https://cloudxls.com/)

## Installing

`npm install cloudxls`

## Usage

Obtain an API key from [here](https://cloudxls.com/private_beta_signup).

```js
var CloudXLS = require('cloudxls');
var cloudxls = new CloudXLS('YOUR-API-KEY');
// cloudxls is now ready to execute API requests to cloudxls.com
```

Alternatively, you can set the ENV variable `CLOUDXLS_API_KEY`.

## Documentation

Please refer to https://cloudxls.com/api/docs for up-to-date documentation
on API parameters.

## API

### CloudXLS(api_key OR settings)

Creates a CloudXLS instance using `api_key`
or a `settings` object.

Settings:

 - `api_url` : The API url endpoint.
 - `api_key` : Your API key.

### #inline(data)

Executes a `mode=inline` API request. Returns a `Request` stream.

Example:

```js
var fs = require('fs');
var CloudXLS = require('cloudxls');
var cloudxls = new CloudXLS('YOUR-API-KEY');

var xls = cloudxls.inline({
  data: {
    text: 'Greeting,Greetee\nHello,World'
  },
  sheet: {
    name: 'Hello World'
  }
});

var file = fs.createWriteStream(__dirname + '/out.xls');

xls.pipe(file); // writes response excel to file
```

### #async(data, fn)

Executes a `mode=async` API request and callbacks `fn`.

```js
var CloudXLS = require('cloudxls');
var cloudxls = new CloudXLS('YOUR-API-KEY');

cloudxls.async({
  data: {
    text: 'Greeting,Greetee\nHello,World'
  },
  sheet: {
    name: 'Hello World'
  },
  doc: {
    filename: 'hello-world'
  }
}, function(err, res, body){
  console.log(body);
  // { uuid: '409a9ff7-f02a-4727-98b8-2321e9992af6',
  //   url: 'https://cloudxls.com/b/download/409a9ff7-f02a-4727-98b8-2321e9992af6/hello-world.xls' }
});
```

Also, check out the [examples](https://github.com/cloudxls/cloudxls-node/tree/master/examples).

## Notes

Uses [mikeal/request](https://github.com/mikeal/request) for the API requests,
refer to its documentation to learn about the callback parameters and how to use
the returned Stream-like `Request` object.

## Testing

Clone the repository and run: `make test`

## License

MIT
